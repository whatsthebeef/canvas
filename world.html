<?xml version="1.0"?>
<html>
<head>
<script src="js/jquery-1.7.1.js"> </script>
<script src="js/Array+manipulations.js"> </script>
<script src="js/processing-1.3.6.js"> </script>
<script src="js/world.js"> </script>
<script>
    $(document).ready(function(){
        var canvas = $("#canvas")[0];
        var sketch = new Processing.Sketch(sketchProc);
        var processingInstance = new Processing(canvas, sketch);

        WORLD.draw(processingInstance);
        // setInterval(function(){WORLD.draw(processingInstance);}, 1000);

        var sizeIncrementInput = WORLD.getElement("size_increment");
        var sizeDecrementInput = WORLD.getElement("size_decrement");
        var sizeInput = WORLD.getElement("size");
        var xposInput = WORLD.getElement("xpos");
        var yposInput = WORLD.getElement("ypos");
        var zposInput = WORLD.getElement("zpos");
        var colorInput = WORLD.getElement("color");

        function updateInputs(){
            sizeInput.value = 5;
            xposInput.value = WORLD.objectRegistry().currentSelection().position.xpos;
            yposInput.value = WORLD.objectRegistry().currentSelection().position.ypos;
            zposInput.value = WORLD.objectRegistry().currentSelection().position.zpos;
            colorInput.value = WORLD.objectRegistry().currentSelection().originalColor.toString(16);
        }

        WORLD.addEventListener("shapeselected", updateInputs);

        function attachTextListener(input, func) {
          if (window.addEventListener) {
            input.addEventListener('input', func, false);
          } else
            input.attachEvent('onpropertychange', function() {
              func.call(input);
            });
        }

        sizeIncrementInput.addEventListener('click', function(){
            WORLD.objectRegistry().currentSelection().resize(100 + parseInt(sizeInput.value));
            processingInstance.draw();
                }, false);

        sizeDecrementInput.addEventListener('click', function(){
            WORLD.objectRegistry().currentSelection().resize(100 - parseInt(sizeInput.value));
            processingInstance.draw();
                }, false);

        attachTextListener(xposInput, function() {
            WORLD.objectRegistry().currentSelection().position.xpos = xposInput.value;
            processingInstance.draw();
        });
        attachTextListener(yposInput, function() {
            WORLD.objectRegistry().currentSelection().position.ypos = yposInput.value;
            processingInstance.draw();
        });
        attachTextListener(zposInput, function() {
            WORLD.objectRegistry().currentSelection().position.zpos = zposInput.value;
            processingInstance.draw();
        });
        attachTextListener(colorInput, function() {
            WORLD.objectRegistry().currentSelection().originalColor = parseInt(colorInput.value, 16);
            processingInstance.draw();
        });
    });
</script>
<link href="css/world.css" type="text/css" rel="stylesheet"></link>
</head>
<body>
    <canvas id="canvas"> </canvas>
    <div id="controls">
        <div class="control">
            <label for="size">Size</label>
            <div class="button" id="size_increment"><div class="inner_button">+</div></div>
            <div class="button minus" id="size_decrement"><div class="inner_button minus">-</div></div>
            <input type="text" name="size" id="size" placeholder="Increment by"></input>
        </div>
        <div class="control">
            <label for="xpos">Position</label>
            <input class="coords" type="text" name="xpos" id="xpos" placeholder="x pos"></input>
            <input class="coords" type="text" name="ypos" id="ypos" placeholder="y pos"></input>
            <input class="coords" type="text" name="zpos" id="zpos" placeholder="z pos"></input>
        </div>
        <div class="control">
            <label for="color">Color</label>
            <input type="text" name="color" id="color" placeholder="In hex scale"></input>
        <br/>
    </div>
</body>
</html>
